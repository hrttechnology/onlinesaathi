!function(u){var f,m,a,z,y,O,v,r,g,I,i,l,R;function h(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function x(e,n,i){e.addEventListener(n,i,!1)}function T(e,n,i){e.removeEventListener(n,i,!1)}function o(e){return y+"["+(n="Host page: "+(e=e),n=window.top!==window.self?window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e:n)+"]";var n}function t(e){return I[e]?I[e].log:m}function F(e,n){s("log",e,n,t(e))}function E(e,n){s("info",e,n,t(e))}function M(e,n){s("warn",e,n,!0)}function s(e,n,i,t){!0===t&&"object"==typeof window.console&&console[e](o(n),i)}function e(e){function i(){l("Height"),l("Width"),A(function(){P(s),S(d),a("onResized",s)},s,"init")}function u(){var e=r.substr(O).split(":"),n=e[1]?parseInt(e[1],10):0,i=I[e[0]]&&I[e[0]].iframe,t=getComputedStyle(i);return{iframe:i,id:e[0],height:n+function(e){if("border-box"!==e.boxSizing)return 0;var n=e.paddingTop?parseInt(e.paddingTop,10):0,e=e.paddingBottom?parseInt(e.paddingBottom,10):0;return n+e}(t)+function(e){if("border-box"!==e.boxSizing)return 0;var n=e.borderTopWidth?parseInt(e.borderTopWidth,10):0,e=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0;return n+e}(t),width:e[2],type:e[3]}}function l(e){var n=Number(I[d]["max"+e]),i=Number(I[d]["min"+e]),e=e.toLowerCase(),t=Number(s[e]);F(d,"Checking "+e+" is in range "+i+"-"+n),t<i&&(t=i,F(d,"Set "+e+" to min value")),n<t&&(t=n,F(d,"Set "+e+" to max value")),s[e]=""+t}function f(){var t=e.origin,o=I[d]&&I[d].checkOrigin;if(o&&""+t!="null"&&!function(){if(o.constructor!==Array)return e=I[d]&&I[d].remoteHost,F(d,"Checking connection is from: "+e),t===e;var e,n=0,i=!1;for(F(d,"Checking connection is from allowed list of origins: "+o);n<o.length;n++)if(o[n]===t){i=!0;break}return i}())throw new Error("Unexpected message received from: "+t+" for "+s.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return 1}function t(e){return r.substr(r.indexOf(":")+z+e)}function m(i,t){var e,n,o;e=function(){var e,n;k("Send Page Info","pageInfo:"+(e=document.body.getBoundingClientRect(),n=s.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(n.top-e.top,10),offsetLeft:parseInt(n.left-e.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})),i,t)},n=32,R[o=t]||(R[o]=setTimeout(function(){R[o]=null,e()},n))}function g(e){e=e.getBoundingClientRect();return N(d),{x:Math.floor(Number(e.left)+Number(v.x)),y:Math.floor(Number(e.top)+Number(v.y))}}function h(e){var n=e?g(s.iframe):{x:0,y:0},i={x:Number(s.width)+n.x,y:Number(s.height)+n.y};F(d,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),window.top!==window.self?window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](i.x,i.y):M(d,"Unable to scroll to requested position, window.parentIFrame not found"):(v=i,w(),F(d,"--"))}function w(){!1!==a("onScroll",v)?S(d):H()}function p(e){var e=e.split("#")[1]||"",n=decodeURIComponent(e),n=document.getElementById(n)||document.getElementsByName(n)[0];n?(n=g(n),F(d,"Moving to in page link (#"+e+") at x: "+n.x+" y: "+n.y),v={x:n.x,y:n.y},w(),F(d,"--")):window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(e):F(d,"In page link #"+e+" not found and window.parentIFrame not found"):F(d,"In page link #"+e+" not found")}function a(e,n){return W(d,e,n)}function b(){switch(I[d]&&I[d].firstRun&&I[d]&&(I[d].firstRun=!1),s.type){case"close":C(s.iframe);break;case"message":n=t(6),F(d,"onMessage passed: {iframe: "+s.iframe.id+", message: "+n+"}"),a("onMessage",{iframe:s.iframe,message:JSON.parse(n)}),F(d,"--");break;case"autoResize":I[d].autoResize=JSON.parse(t(9));break;case"scrollTo":h(!1);break;case"scrollToOffset":h(!0);break;case"pageInfo":m(I[d]&&I[d].iframe,d),r=d,e("Add ",x),I[r]&&(I[r].stopPageInfo=o);break;case"pageInfoStop":I[d]&&I[d].stopPageInfo&&(I[d].stopPageInfo(),delete I[d].stopPageInfo);break;case"inPageLink":p(t(9));break;case"reset":j(s);break;case"init":i(),a("onInit",s.iframe);break;default:i()}function e(n,i){function t(){I[r]?m(I[r].iframe,r):o()}["scroll","resize"].forEach(function(e){F(r,n+e+" listener for sendPageInfo"),i(window,e,t)})}function o(){e("Remove ",T)}var r,n}var n,o,r=e.data,s={},d=null;if("[iFrameResizerChild]Ready"===r)for(var c in I)k("iFrame requested init",B(c),I[c].iframe,c);else y===(""+r).substr(0,O)&&r.substr(O).split(":")[0]in I?(s=u(),d=s.id,I[d]&&(I[d].loaded=!0),(o=s.type in{true:1,false:1,undefined:1})&&F(d,"Ignoring init message from meta parent page"),!o&&(o=!0,I[n=d]||(o=!1,M(s.type+" No settings for "+n+". Message was: "+r)),o)&&(F(d,"Received: "+r),n=!0,null===s.iframe&&(M(d,"IFrame ("+s.id+") not found"),n=!1),n&&f()&&b())):E(d,"Ignored: "+r)}function W(e,n,i){var t=null,o=null;if(I[e]){if("function"!=typeof(t=I[e][n]))throw new TypeError(n+" on iFrame["+e+"] is not a function");o=t(i)}return o}function w(e){e=e.id;delete I[e]}function C(e){var n=e.id;if(!1!==W(n,"onClose",n)){F(n,"Removing iFrame: "+n);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){M(e)}W(n,"onClosed",n),F(n,"--"),w(e)}else F(n,"Close iframe cancelled by onClose event")}function N(e){null===v&&F(e,"Get page position: "+(v={x:window.pageXOffset!==u?window.pageXOffset:document.documentElement.scrollLeft,y:window.pageYOffset!==u?window.pageYOffset:document.documentElement.scrollTop}).x+","+v.y)}function S(e){null!==v&&(window.scrollTo(v.x,v.y),F(e,"Set page position: "+v.x+","+v.y),H())}function H(){v=null}function j(e){F(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),N(e.id),A(function(){P(e),k("reset","reset",e.iframe,e.id)},e,"reset")}function P(o){function i(e){var n;function i(){Object.keys(I).forEach(function(e){function n(e){return"0px"===(I[i]&&I[i].iframe.style[e])}var i;I[i=e]&&null!==I[i].iframe.offsetParent&&(n("height")||n("width"))&&k("Visibility change","resize",I[i].iframe,i)})}function t(e){F("window","Mutation observed: "+e[0].target+" "+e[0].type),c(i,16)}a||"0"!==o[e]||(a=!0,F(r,"Hidden iFrame detected, creating visibility listener"),(e=h())&&(n=document.querySelector("body"),new e(t).observe(n,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0})))}function e(e){var n;n=e,o.id?(o.iframe.style[n]=o[n]+"px",F(o.id,"IFrame ("+r+") "+n+" set to "+o[n]+"px")):F("undefined","messageData id not set"),i(e)}var r=o.iframe.id;I[r]&&(I[r].sizeHeight&&e("height"),I[r].sizeWidth&&e("width"))}function A(e,n,i){i!==n.type&&r&&!window.jasmine?(F(n.id,"Requesting animation frame"),r(e)):e()}function k(n,i,t,o,e){function r(){var e;t&&"contentWindow"in t&&null!==t.contentWindow?(e=I[o]&&I[o].targetOrigin,F(o,"["+n+"] Sending msg to iframe["+o+"] ("+i+") targetOrigin: "+e),t.contentWindow.postMessage(y+i,e)):M(o,"["+n+"] IFrame("+o+") not found")}function a(){e&&I[o]&&I[o].warningTimeout&&(I[o].msgTimeout=setTimeout(function(){!I[o]||I[o].loaded||s||(s=!0,M(o,"IFrame has not responded within "+I[o].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))},I[o].warningTimeout))}var s=!1;o=o||t.id,I[o]&&(r(),a())}function B(e){return e+":"+I[e].bodyMarginV1+":"+I[e].sizeWidth+":"+I[e].log+":"+I[e].interval+":"+I[e].enablePublicMethods+":"+I[e].autoResize+":"+I[e].bodyMargin+":"+I[e].heightCalculationMethod+":"+I[e].bodyBackground+":"+I[e].bodyPadding+":"+I[e].tolerance+":"+I[e].inPageLinks+":"+I[e].resizeFrom+":"+I[e].widthCalculationMethod}function d(t,e){function n(i){var e=h();e&&(e=e,t.parentNode&&new e(function(e){e.forEach(function(e){Array.prototype.slice.call(e.removedNodes).forEach(function(e){e===t&&C(t)})})}).observe(t.parentNode,{childList:!0})),x(t,"load",function(){var e,n;k("iFrame.onload",i,t,u,!0),e=I[s]&&I[s].firstRun,n=I[s]&&I[s].heightCalculationMethod in g,!e&&n&&j({iframe:t,height:0,width:0,type:"init"})}),k("init",i,t,u,!0)}function o(e){var n=e.split("Callback");2===n.length&&(this[n="on"+n[0].charAt(0).toUpperCase()+n[0].slice(1)]=this[e],delete this[e],M(s,"Deprecated: '"+e+"' has been renamed '"+n+"'. The old method will be removed in the next major version."))}function i(e){if(e=e||{},I[s]={firstRun:!0,iframe:t,remoteHost:t.src&&t.src.split("/").slice(0,3).join("/")},"object"!=typeof e)throw new TypeError("Options is not an object");Object.keys(e).forEach(o,e);var n,i=e;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(I[s][n]=(Object.prototype.hasOwnProperty.call(i,n)?i:l)[n]);I[s]&&(I[s].targetOrigin=!0===I[s].checkOrigin?""===(e=I[s].remoteHost)||null!==e.match(/^(about:blank|javascript:|file:\/\/)/)?"*":e:"*")}""===(r=t.id)&&(t.id=(a=e&&e.id||l.id+f++,null!==document.getElementById(a)&&(a+=f++),r=a),m=(e||{}).log,F(r,"Added missing iframe ID: "+r+" ("+t.src+")"));var r,a,s=r;if(s in I&&"iFrameResizer"in t)M(s,"Ignored iFrame, already setup.");else{switch(i(e),F(s,"IFrame scrolling "+(I[s]&&I[s].scrolling?"enabled":"disabled")+" for "+s),t.style.overflow=!1===(I[s]&&I[s].scrolling)?"hidden":"auto",I[s]&&I[s].scrolling){case"omit":break;case!0:t.scrolling="yes";break;case!1:t.scrolling="no";break;default:t.scrolling=I[s]?I[s].scrolling:"no"}c("Height"),c("Width"),d("maxHeight"),d("minHeight"),d("maxWidth"),d("minWidth"),"number"!=typeof(I[s]&&I[s].bodyMargin)&&"0"!==(I[s]&&I[s].bodyMargin)||(I[s].bodyMarginV1=I[s].bodyMargin,I[s].bodyMargin=I[s].bodyMargin+"px"),n(B(s)),I[s]&&(I[s].iframe.iFrameResizer={close:C.bind(null,I[s].iframe),removeListeners:w.bind(null,I[s].iframe),resize:k.bind(null,"Window resize","resize",I[s].iframe),moveToAnchor:function(e){k("Move to anchor","moveToAnchor:"+e,I[s].iframe,s)},sendMessage:function(e){k("Send Message","message:"+(e=JSON.stringify(e)),I[s].iframe,s)}})}function d(e){1/0!==I[s][e]&&0!==I[s][e]&&(t.style[e]=I[s][e]+"px",F(s,"Set "+e+" = "+I[s][e]+"px"))}function c(e){if(I[s]["min"+e]>I[s]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}}function c(e,n){null===i&&(i=setTimeout(function(){i=null,e()},n))}function n(){"hidden"!==document.visibilityState&&(F("document","Trigger event: Visiblity change"),c(function(){p("Tab Visable","resize")},16))}function p(i,t){Object.keys(I).forEach(function(e){var n;I[n=e]&&"parent"===I[n].resizeFrom&&I[n].autoResize&&!I[n].firstRun&&k(i,t,I[e].iframe,e)})}function b(){x(window,"message",e),x(window,"resize",function(){var e;F("window","Trigger event: "+(e="resize")),c(function(){p("Window "+e,"resize")},16)}),x(document,"visibilitychange",n),x(document,"-webkit-visibilitychange",n)}function L(){function t(e,n){if(n){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">");d(n,e),o.push(n)}}for(var o,e=["moz","webkit","o","ms"],n=0;n<e.length&&!r;n+=1)r=window[e[n]+"RequestAnimationFrame"];return r?r=r.bind(window):F("setup","RequestAnimationFrame not supported"),b(),function(e,n){var i;switch(o=[],(i=e)&&i.enablePublicMethods&&M("enablePublicMethods option has been removed, public methods are now always available in the iFrame"),typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),t.bind(u,e));break;case"object":t(e,n);break;default:throw new TypeError("Unexpected data type ("+typeof n+")")}return o}}function q(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(i){return this.filter("iframe").each(function(e,n){d(n,i)}).end()}):E("","Unable to bind to jQuery, it is not fully loaded.")}"undefined"!=typeof window&&(f=0,a=m=!1,z="message".length,O=(y="[iFrameSizer]").length,v=null,r=window.requestAnimationFrame,l={autoResize:!(i=null),bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!(I={}),enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!(g={max:1,scroll:1,bodyScroll:1,documentElementScroll:1}),maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return!0},onClosed:function(){},onInit:function(){},onMessage:function(){M("onMessage function not defined")},onResized:function(){},onScroll:function(){return!0}},R={},window.jQuery&&q(window.jQuery),"function"==typeof define&&define.amd?define([],L):"object"==typeof module&&"object"==typeof module.exports&&(module.exports=L()),window.iFrameResize=window.iFrameResize||L())}();